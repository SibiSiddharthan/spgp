/*
   Copyright (c) 2024 - 2025 Sibi Siddharthan

   Distributed under the MIT license.
   Refer to the LICENSE file at the root directory for details.
*/

#ifndef SPGP_ERROR_H
#define SPGP_ERROR_H

typedef enum _pgp_error_t
{
	// No error
	PGP_SUCCESS = 0,

	// General errors
	PGP_NO_MEMORY,
	PGP_INSUFFICIENT_DATA,
	PGP_BUFFER_TOO_SMALL,
	PGP_INVALID_PARAMETER,
	PGP_INCORRECT_FUNCTION,
	PGP_EMPTY_PASSPHRASE,
	PGP_INTERNAL_BUG,

	// Packet errors
	PGP_MALFORMED_PACKET_HEADER,
	PGP_MALFORMED_PACKET_LEGACY_HEADER,
	PGP_MALFORMED_SUBPACKET_HEADER,
	PGP_MALFORMED_PARTIAL_LENGTH_HEADER,
	PGP_UNKNOWN_HEADER_FORMAT,
	PGP_UNKNOWN_PACKET_TAG,
	PGP_INVALID_PARTIAL_PACKET_TYPE,
	PGP_INVALID_PARTIAL_PACKET_START_SIZE,
	PGP_INVALID_PARTIAL_PACKET_CONTINUE_SIZE,
	PGP_UNKNOWN_CRITICAL_SUBPACKET,
	PGP_PACKET_TOO_BIG,
	PGP_EMPTY_PACKET,

	// Cryptographic errors
	PGP_RAND_ERROR,
	PGP_UNKNOWN_HASH_ALGORITHM,
	PGP_UNKNOWN_CIPHER_ALGORITHM,
	PGP_UNKNOWN_PUBLIC_ALGORITHM,
	PGP_UNKNOWN_AEAD_ALGORITHM,
	PGP_UNKNOWN_SIGNATURE_ALGORITHM,
	PGP_UNKNOWN_KEY_EXCHANGE_ALGORITHM,
	PGP_INVALID_AEAD_CIPHER_PAIR,
	PGP_UNSUPPORTED_HASH_ALGORITHM,
	PGP_UNSUPPORTED_AEAD_ALGORITHM,
	PGP_UNSUPPORTED_CIPHER_ALGORITHM,
	PGP_UNSUPPORTED_SIGNATURE_ALGORITHM,
	PGP_UNSUPPORTED_KEY_EXCHANGE_ALGORITHM,
	PGP_INVALID_CFB_IV_SIZE,
	PGP_INVALID_AEAD_IV_SIZE,
	PGP_INVALID_HASH_SALT_SIZE,
	PGP_INVALID_CIPHER_KEY_SIZE,
	PGP_INVALID_HASH_SIZE_FOR_ALGORITHM,
	PGP_EMPTY_IV,
	PGP_CFB_IV_CHECK_MISMATCH,
	PGP_MDC_TAG_MISMATCH,
	PGP_AEAD_TAG_MISMATCH,
	PGP_QUICK_HASH_MISMATCH,
	PGP_ARGON2_HASH_ERROR,

	// Armor errors
	PGP_ARMOR_UNKNOWN_MARKER,
	PGP_ARMOR_MARKER_MISMATCH,
	PGP_ARMOR_UNKNOWN_HEADER,
	PGP_ARMOR_TOO_BIG,
	PGP_ARMOR_LINE_TOO_BIG,
	PGP_ARMOR_MALFORMED_BASE64_DATA,
	PGP_ARMOR_CRC_MISMATCH,
	PGP_ARMOR_INVALID_MARKER_FOR_TRANSFERABLE_PUBLIC_KEY,
	PGP_ARMOR_INVALID_MARKER_FOR_TRANSFERABLE_SECRET_KEY,
	PGP_ARMOR_INVALID_MARKER_FOR_SIGNATURE,

	// S2K errors
	PGP_UNKNOWN_S2K_USAGE,
	PGP_UNKNOWN_S2K_SPECIFIER,
	PGP_MALFORMED_S2K_SIZE,
	PGP_EMPTY_S2K,

	// Key errors
	PGP_UNKNOWN_KEY_VERSION,
	PGP_INVALID_KEY_TYPE,

	PGP_MALFORMED_PUBLIC_KEY_PACKET,
	PGP_MALFORMED_SECRET_KEY_PACKET,
	PGP_MALFORMED_PUBLIC_KEY_COUNT,
	PGP_MALFORMED_SECRET_KEY_COUNT,
	PGP_MALFORMED_KEYDEF_PACKET,

	PGP_EMPTY_PUBLIC_KEY,
	PGP_EMPTY_SECRET_KEY,

	PGP_MALFORMED_RSA_PUBLIC_KEY,
	PGP_MALFORMED_ELGAMAL_PUBLIC_KEY,
	PGP_MALFORMED_DSA_PUBLIC_KEY,
	PGP_MALFORMED_ECDSA_PUBLIC_KEY,
	PGP_MALFORMED_EDDSA_PUBLIC_KEY,
	PGP_MALFORMED_ECDH_PUBLIC_KEY,
	PGP_MALFORMED_X25519_PUBLIC_KEY,
	PGP_MALFORMED_X448_PUBLIC_KEY,
	PGP_MALFORMED_ED25519_PUBLIC_KEY,
	PGP_MALFORMED_ED448_PUBLIC_KEY,

	PGP_MALFORMED_RSA_SECRET_KEY,
	PGP_MALFORMED_ELGAMAL_SECRET_KEY,
	PGP_MALFORMED_DSA_SECRET_KEY,
	PGP_MALFORMED_ECDSA_SECRET_KEY,
	PGP_MALFORMED_EDDSA_SECRET_KEY,
	PGP_MALFORMED_ECDH_SECRET_KEY,
	PGP_MALFORMED_X25519_SECRET_KEY,
	PGP_MALFORMED_X448_SECRET_KEY,
	PGP_MALFORMED_ED25519_SECRET_KEY,
	PGP_MALFORMED_ED448_SECRET_KEY,

	PGP_INVALID_CIPHER_ALGORITHM_FOR_LEGACY_CFB,
	PGP_KEY_CHECKSUM_MISMATCH,

	PGP_UNUSABLE_KEY_FOR_CERTIFICATION,
	PGP_UNUSABLE_KEY_FOR_SIGNING,
	PGP_UNUSABLE_KEY_FOR_ENCRYPTION,
	PGP_UNUSABLE_KEY_FOR_AUTHENTICATION,

	PGP_RSA_KEY_UNSUPPORTED_BIT_SIZE,
	PGP_RSA_KEY_GENERATION_FAILURE,
	PGP_DSA_KEY_UNSUPPORTED_BIT_SIZE,
	PGP_DSA_KEY_GENERATION_FAILURE,
	PGP_ELGAMAL_KEY_UNSUPPORTED_BIT_SIZE,
	PGP_ELGAMAL_KEY_GENERATION_FAILURE,

	PGP_UNSUPPORTED_ELLIPTIC_CURVE,
	PGP_UNSUPPORTED_EDWARDS_CURVE,
	PGP_ELLIPTIC_CURVE_KEY_GENERATION_FAILURE,
	PGP_ECDSA_KEY_GENERATION_FAILURE,
	PGP_EDDSA_KEY_GENERATION_FAILURE,
	PGP_ECDH_KEY_GENERATION_FAILURE,

	PGP_X25519_KEY_GENERATION_FAILURE,
	PGP_X448_KEY_GENERATION_FAILURE,
	PGP_ED25519_KEY_GENERATION_FAILURE,
	PGP_ED448_KEY_GENERATION_FAILURE,

	PGP_INVALID_KEY_TRANSFORMATION,
	PGP_KEY_NOT_DECRYPTED,

	// Session errors
	PGP_MALFORMED_RSA_SESSION_KEY,
	PGP_MALFORMED_ELGAMAL_SESSION_KEY,
	PGP_MALFORMED_ECDH_SESSION_KEY,
	PGP_MALFORMED_X25519_SESSION_KEY,
	PGP_MALFORMED_X448_SESSION_KEY,

	PGP_UNKNOWN_PUBLIC_SESSION_PACKET_VERSION,
	PGP_MALFORMED_PUBLIC_SESSION_PACKET,
	PGP_MALFORMED_PUBLIC_SESSION_PACKET_COUNT,

	PGP_UNKNOWN_SYMMETRIC_SESSION_PACKET_VERSION,
	PGP_MALFORMED_SYMMETRIC_SESSION_PACKET,
	PGP_MALFORMED_SYMMETRIC_SESSION_PACKET_COUNT,

	PGP_SESSION_KEY_CHECKSUM_MISMATCH,
	PGP_SESSION_KEY_MALFORMED_PADDING,
	PGP_INCORRECT_DECRYPTION_KEY,

	PGP_RSA_ENCRYPTION_FAILURE,
	PGP_RSA_DECRYPTION_FAILURE,
	PGP_ELGAMAL_ENCRYPTION_FAILURE,
	PGP_ELGAMAL_DECRYPTION_FAILURE,
	PGP_ECDH_ENCRYPTION_FAILURE,
	PGP_ECDH_DECRYPTION_FAILURE,
	PGP_X25519_ENCRYPTION_FAILURE,
	PGP_X25519_DECRYPTION_FAILURE,
	PGP_X448_ENCRYPTION_FAILURE,
	PGP_X448_DECRYPTION_FAILURE,

	// Signature errors
	PGP_UNKNOWN_SIGNATURE_TYPE,
	PGP_UNKNOWN_SIGNATURE_PACKET_VERSION,
	PGP_MALFORMED_SIGNATURE_PACKET,
	PGP_UNKNOWN_SIGNATURE_SUBPACKET_TAG,
	PGP_MALFORMED_SIGNATURE_PACKET_SALT_SIZE,
	PGP_MALFORMED_SIGNATURE_HASHED_SUBPACKET_SIZE,
	PGP_MALFORMED_SIGNATURE_UNHASHED_SUBPACKET_SIZE,

	PGP_UNKNOWN_ONE_PASS_SIGNATURE_PACKET_VERSION,
	PGP_MALFORMED_ONE_PASS_SIGNATURE_PACKET,

	PGP_MALFORMED_SIGNATURE_CREATION_TIME_SUBPACKET,
	PGP_MALFORMED_SIGNATURE_EXPIRY_TIME_SUBPACKET,
	PGP_MALFORMED_KEY_EXPIRATION_TIME_SUBPACKET,
	PGP_MALFORMED_EXPORTABLE_SUBPACKET,
	PGP_MALFORMED_REVOCABLE_SUBPACKET,
	PGP_MALFORMED_PRIMARY_USER_ID_SUBPACKET,
	PGP_MALFORMED_KEY_SERVER_PREFERENCES_SUBPACKET,
	PGP_MALFORMED_KEY_FLAGS_SUBPACKET,
	PGP_MALFORMED_FEATURES_SUBPACKET,
	PGP_MALFORMED_PREFERRED_SYMMETRIC_CIPHERS_SUBPACKET,
	PGP_MALFORMED_PREFERRED_HASH_ALGORITHMS_SUBPACKET,
	PGP_MALFORMED_PREFERRED_COMPRESSION_ALGORITHMS_SUBPACKET,
	PGP_MALFORMED_PREFERRED_ENCRYPTION_MODES_SUBPACKET,
	PGP_MALFORMED_PREFERRED_AEAD_CIPHERSUITES_SUBPACKET,
	PGP_MALFORMED_ISSUER_FINGERPRINT_SUBPACKET,
	PGP_MALFORMED_RECIPIENT_FINGERPRINT_SUBPACKET,
	PGP_MALFORMED_REGULAR_EXPRESSION_SUBPACKET,
	PGP_MALFORMED_PREFERRED_KEY_SERVER_SUBPACKET,
	PGP_MALFORMED_POLICY_URI_SUBPACKET,
	PGP_MALFORMED_SIGNER_USER_ID_SUBPACKET,
	PGP_MALFORMED_TRUST_SIGNATURE_SUBPACKET,
	PGP_MALFORMED_REVOCATION_KEY_SUBPACKET,
	PGP_MALFORMED_ISSUER_KEY_ID_SUBPACKET,
	PGP_MALFORMED_NOTATION_DATA_SUBPACKET,
	PGP_MALFORMED_REASON_FOR_REVOCATION_SUBPACKET,
	PGP_MALFORMED_SIGNATURE_TARGET_SUBPACKET,
	PGP_MALFORMED_EMBEDDED_SIGNATURE_SUBPACKET,
	PGP_MALFORMED_ATTESTED_CERTIFICATIONS_SUBPACKET,
	PGP_MALFORMED_LITERAL_DATA_META_HASH_SUBPACKET,

	PGP_EMPTY_SIGNATURE,
	PGP_MALFORMED_RSA_SIGNATURE,
	PGP_MALFORMED_DSA_SIGNATURE,
	PGP_MALFORMED_ECDSA_SIGNATURE,
	PGP_MALFORMED_EDDSA_SIGNATURE,
	PGP_MALFORMED_ED25519_SIGNATURE,
	PGP_MALFORMED_ED448_SIGNATURE,

	PGP_RSA_SIGNATURE_GENERATION_FAILURE,
	PGP_DSA_SIGNATURE_GENERATION_FAILURE,
	PGP_ECDSA_SIGNATURE_GENERATION_FAILURE,
	PGP_EDDSA_SIGNATURE_GENERATION_FAILURE,
	PGP_ED25519_SIGNATURE_GENERATION_FAILURE,
	PGP_ED448_SIGNATURE_GENERATION_FAILURE,

	PGP_INCOMPATIBLE_SIGNATURE_AND_KEY_VERSION,
	PGP_MISSING_EMBEDDED_SIGNATURE_PACKET,
	PGP_BAD_SIGNATURE,

	PGP_SIGNATURE_SALT_TOO_BIG,
	PGP_INVALID_LITERAL_PACKET_FORMAT_FOR_TEXT_SIGNATURE,
	PGP_UNKNOWN_REVOCATION_CLASS,
	PGP_INVALID_KEY_FINGERPRINT_SIZE,

	// Encrypted Packet errors
	PGP_MALFORMED_SEIPD_PACKET,
	PGP_UNKNOWN_SEIPD_PACKET_VERSION,
	PGP_MALFORMED_AEAD_PACKET,
	PGP_UNKNOWN_AEAD_PACKET_VERSION,
	PGP_INVALID_CHUNK_SIZE,
	PGP_RECURSIVE_ENCRYPTION_CONTAINER,

	// Compressed Packet
	PGP_UNSUPPORTED_COMPRESSION_ALGORITHM,
	PGP_UNKNOWN_COMPRESSION_ALGORITHM,
	PGP_MALFORMED_COMPRESSED_PACKET,
	PGP_RECURSIVE_COMPRESSION_CONTAINER,

	// Marker Packet
	PGP_MALFORMED_MARKER_PACKET,

	// MDC Packet
	PGP_MALFORMED_MDC_PACKET,

	// Literal Packet
	PGP_UNKNOWN_LITERAL_FORMAT,
	PGP_MALFORMED_LITERAL_PACKET,
	PGP_MALFORMED_LITERAL_PACKET_FILENAME_SIZE,

	// User ID Packet
	PGP_EMPTY_USER_ID,

	// User Attribute Packet
	PGP_MALFORMED_USER_ATTRIBUTE_IMAGE,
	PGP_MALFORMED_USER_ATTRIBUTE_ID,
	PGP_UNKNOWN_USER_ATTRIBUTE_SUBPACKET_TAG,
	PGP_UNSUPPORTED_IMAGE_TYPE,
	PGP_IMAGE_NOT_PRESENT_IN_USER_ATTRIBUTE,
	PGP_ID_NOT_PRESENT_IN_USER_ATTRIBUTE,

	// Trust Packet
	PGP_UNKNOWN_TRUST_LEVEL,
	PGP_MALFORMED_TRUST_PACKET,

	// Padding Packet
	PGP_EMPTY_PADDING_PACKET,

	// Keyring Packet
	PGP_MALFORMED_KEYRING_PACKET,
	PGP_MALFORMED_KEYRING_PRIMARY_KEY,
	PGP_MALFORMED_KEYRING_SUBKEYS,
	PGP_MALFORMED_KEYRING_USER_INFO,
	PGP_KEYRING_PACKET_INVALID_SUBKEY_SIZE,

} pgp_error_t;

char *pgp_error(pgp_error_t status);

#endif
